<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        body {background-color: black;
            color: white;}
    </style>
</head>
<body>

<p>Image:</p>
<img id="img" src="problem.png">
<p>Canvas:</p>
<canvas id="myCanvas" style="border: 1px solid white;"></canvas>
<pre id="text" style="border: 1px solid white; line-height: 100%"></pre>
<script>


    // var c = document.getElementById("myCanvas");
    // var ctx = c.getContext("2d");
    // var imgData = ctx.createImageData(100, 100);
    // var i;
    // var temp = 0;
   // setInterval(
        window.onload = function() {

        var text = document.getElementById("text");
        text.innerText = "";

        var c = document.getElementById("myCanvas");
        var ctx = c.getContext("2d");
        var img = document.getElementById("img");
        c.width = img.clientWidth;
        c.height = img.clientHeight;
        console.log(img.clientWidth);


        ctx.drawImage(img, 0, 0, img.clientWidth, img.clientHeight);

        var imgData = ctx.getImageData(0, 0, c.width, c.height);

        var i;
        for (i = 0; i < imgData.data.length; i += 4) {
            // imgData.data[i] = 255 - imgData.data[i];
            // imgData.data[i+1] = 255 - imgData.data[i+1];
            // imgData.data[i+2] = 255 - imgData.data[i+2];
            // imgData.data[i+3] = 255;

            // Get the pixel of the red channel.
            r = imgData.data[i]
            // Get the pixel of the green channel.
            g = imgData.data[i+1]
            // Get the pixel of the blue channel.
            b = imgData.data[i+2]
            // Get the pixel of the alpha channel.
            a = imgData.data[i+3]
            // Transform RGB color space to gray scale.
            gray =  (0.299 * r + 0.587 * g + 0.114 * b)

            if ( gray > 120 )
            {
                // Set the pixel is white.
                imgData.data[i] = 255;
                imgData.data[i+1] = 255;
                imgData.data[i+2] = 255;
                imgData.data[i+3] = a;
            }
            else
            {
                // Set the pixel is black.
                imgData.data[i] = 0;
                imgData.data[i+1] = 0;
                imgData.data[i+2] = 0;
                imgData.data[i+3] = a;
            }

            if (i%(img.clientWidth*4)==0 && i > 0){
                text.innerText += "\n";
            }
            if (imgData.data[i] > 250 && imgData.data[i+1] > 250 && imgData.data[i+2] > 250){
                text.innerText += String.fromCharCode(Math.floor(Math.random() * (+126 - +33)) + +33)
            }
            else {
                text.innerText += " ";
            }

        }
        ctx.putImageData(imgData, 0, 0);
    }
    //, 1000);



    // # Śnieżący obraz

    // function test() {
    //     text.innerText = "";
    //     for (i = 0; i < imgData.data.length; i += 4) {
    //         var min=0;
    //         var max=255;
    //
    //         imgData.data[i+0] = Math.floor(Math.random() * (+max - +min)) + +min;
    //         imgData.data[i+1] = Math.floor(Math.random() * (+max - +min)) + +min;
    //         imgData.data[i+2] = Math.floor(Math.random() * (+max - +min)) + +min;
    //         imgData.data[i+3] = 255;
    //         temp++;
    //         if (i%125*40==0 && i > 0){
    //             text.innerText += "\n";
    //             temp=0;
    //         }
    //         //text.innerText += Math.floor(Math.random() * (+9 - +0)) + +0;
    //
    //     }
    //     ctx.putImageData(imgData, 10, 10);
    // }
    // // setInterval(test, 100);

</script>



</body>
</html>